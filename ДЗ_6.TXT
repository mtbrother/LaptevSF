/*Практическое задание по теме “Операторы, фильтрация, сортировка и ограничение. Агрегация данных”.
Работаем с БД vk и данными, которые вы сгенерировали ранее:
1.Пусть задан некоторый пользователь. Из всех друзей этого пользователя найдите человека,
который больше всех общался с нашим пользователем.
*/

select from_user_id from messages where to_user_id=1 
group by from_user_id order by count(*) desc limit 1;

/*
2.Подсчитать общее количество лайков, которые получили пользователи младше 10 лет..
*/

select count(*) from likes where user_id in
(select user_id from profiles where (year(now()) - year(birthday)) < 10);

/*
3.Определить кто больше поставил лайков (всего) - мужчины или женщины?*/

select
(select count(*) from likes, profiles
where likes.user_id = profiles.user_id and gender = 'female') as 'likes_from_female',
(select count(*) from likes, profiles
where likes.user_id = profiles.user_id and gender = 'male')  as 'likes_from_male'
from profiles, likes limit 1;